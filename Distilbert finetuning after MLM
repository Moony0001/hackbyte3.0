{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2e96e779",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:17:56.783346Z",
     "iopub.status.busy": "2025-04-04T20:17:56.783033Z",
     "iopub.status.idle": "2025-04-04T20:18:24.621398Z",
     "shell.execute_reply": "2025-04-04T20:18:24.620485Z"
    },
    "papermill": {
     "duration": 27.852731,
     "end_time": "2025-04-04T20:18:24.623196",
     "exception": false,
     "start_time": "2025-04-04T20:17:56.770465",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from transformers import AutoModelForSequenceClassification, AutoTokenizer, Trainer, TrainingArguments,EarlyStoppingCallback\n",
    "import pandas as pd\n",
    "from datasets import Dataset\n",
    "import torch\n",
    "import numpy as np\n",
    "from safetensors.torch import load_file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "61903127",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:24.648502Z",
     "iopub.status.busy": "2025-04-04T20:18:24.647927Z",
     "iopub.status.idle": "2025-04-04T20:18:26.003771Z",
     "shell.execute_reply": "2025-04-04T20:18:26.002731Z"
    },
    "papermill": {
     "duration": 1.370522,
     "end_time": "2025-04-04T20:18:26.005714",
     "exception": false,
     "start_time": "2025-04-04T20:18:24.635192",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df=pd.read_csv(\"/kaggle/input/isec-sdc-2025/train.csv\")\n",
    "test_df=pd.read_csv(\"/kaggle/input/isec-sdc-2025/test.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c012aa6d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:26.029280Z",
     "iopub.status.busy": "2025-04-04T20:18:26.029027Z",
     "iopub.status.idle": "2025-04-04T20:18:26.032394Z",
     "shell.execute_reply": "2025-04-04T20:18:26.031762Z"
    },
    "papermill": {
     "duration": 0.01604,
     "end_time": "2025-04-04T20:18:26.033648",
     "exception": false,
     "start_time": "2025-04-04T20:18:26.017608",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df,test_df=df[:1000],test_df[:100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "7296c757",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:26.056252Z",
     "iopub.status.busy": "2025-04-04T20:18:26.055996Z",
     "iopub.status.idle": "2025-04-04T20:18:26.065772Z",
     "shell.execute_reply": "2025-04-04T20:18:26.064945Z"
    },
    "papermill": {
     "duration": 0.023303,
     "end_time": "2025-04-04T20:18:26.067293",
     "exception": false,
     "start_time": "2025-04-04T20:18:26.043990",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df[\"Description\"]=df[\"Description\"].fillna(\"Not provided\")\n",
    "test_df[\"Description\"]=test_df[\"Description\"].fillna(\"Not provided\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b4f2b9db",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:26.089725Z",
     "iopub.status.busy": "2025-04-04T20:18:26.089461Z",
     "iopub.status.idle": "2025-04-04T20:18:26.115501Z",
     "shell.execute_reply": "2025-04-04T20:18:26.114880Z"
    },
    "papermill": {
     "duration": 0.038156,
     "end_time": "2025-04-04T20:18:26.116872",
     "exception": false,
     "start_time": "2025-04-04T20:18:26.078716",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "train_df, val_df = train_test_split(df, test_size=0.25, random_state=7,stratify=df['Priority'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "50de99c4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:26.139005Z",
     "iopub.status.busy": "2025-04-04T20:18:26.138754Z",
     "iopub.status.idle": "2025-04-04T20:18:26.144210Z",
     "shell.execute_reply": "2025-04-04T20:18:26.143176Z"
    },
    "papermill": {
     "duration": 0.01839,
     "end_time": "2025-04-04T20:18:26.145629",
     "exception": false,
     "start_time": "2025-04-04T20:18:26.127239",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(750, 7)\n",
      "(250, 7)\n",
      "(100, 6)\n"
     ]
    }
   ],
   "source": [
    "print(train_df.shape)\n",
    "print(val_df.shape)\n",
    "print(test_df.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "466edb87",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:26.169641Z",
     "iopub.status.busy": "2025-04-04T20:18:26.169379Z",
     "iopub.status.idle": "2025-04-04T20:18:26.176346Z",
     "shell.execute_reply": "2025-04-04T20:18:26.175581Z"
    },
    "papermill": {
     "duration": 0.020032,
     "end_time": "2025-04-04T20:18:26.177457",
     "exception": false,
     "start_time": "2025-04-04T20:18:26.157425",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1.]\n"
     ]
    }
   ],
   "source": [
    "from sklearn.utils.class_weight import compute_class_weight\n",
    "\n",
    "class_weights = compute_class_weight(class_weight='balanced', classes=np.unique(df[\"Priority\"]), y=df[\"Priority\"])\n",
    "\n",
    "print(class_weights)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "c898ea01",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:26.199585Z",
     "iopub.status.busy": "2025-04-04T20:18:26.199328Z",
     "iopub.status.idle": "2025-04-04T20:18:30.927700Z",
     "shell.execute_reply": "2025-04-04T20:18:30.926798Z"
    },
    "papermill": {
     "duration": 4.741124,
     "end_time": "2025-04-04T20:18:30.929177",
     "exception": false,
     "start_time": "2025-04-04T20:18:26.188053",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "ba2be813b40847c69a4c83c3c8b34072",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "tokenizer_config.json:   0%|          | 0.00/49.0 [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9abfbd9100ca47778c62762b6db93b19",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "config.json:   0%|          | 0.00/465 [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "0f032f9810454fcc951409c3ef5e7008",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "vocab.txt:   0%|          | 0.00/213k [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "f7cde791ecf147629067f1f4d4d763dd",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "tokenizer.json:   0%|          | 0.00/436k [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "b360e2ea6a4843f0a4b45cc2e999ef3c",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "model.safetensors:   0%|          | 0.00/263M [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-cased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']\n",
      "You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "_IncompatibleKeys(missing_keys=['pre_classifier.weight', 'pre_classifier.bias', 'classifier.weight', 'classifier.bias'], unexpected_keys=['vocab_layer_norm.bias', 'vocab_layer_norm.weight', 'vocab_projector.bias', 'vocab_transform.bias', 'vocab_transform.weight'])"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tokenizer = AutoTokenizer.from_pretrained(\"distilbert-base-cased\")\n",
    "model = AutoModelForSequenceClassification.from_pretrained('distilbert-base-cased', num_labels=5,output_hidden_states=True,trust_remote_code=True)\n",
    "from safetensors.torch import load_file\n",
    "state_dict = load_file(\"/kaggle/input/bert-mlm/saved_model/model.safetensors\")\n",
    "\n",
    "# Load the state into the model\n",
    "model.load_state_dict(state_dict,strict=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "89797637",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:30.953432Z",
     "iopub.status.busy": "2025-04-04T20:18:30.953189Z",
     "iopub.status.idle": "2025-04-04T20:18:31.670181Z",
     "shell.execute_reply": "2025-04-04T20:18:31.669399Z"
    },
    "papermill": {
     "duration": 0.730858,
     "end_time": "2025-04-04T20:18:31.671778",
     "exception": false,
     "start_time": "2025-04-04T20:18:30.940920",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Token indices sequence length is longer than the specified maximum sequence length for this model (1304 > 512). Running this sequence through the model will result in indexing errors\n"
     ]
    }
   ],
   "source": [
    "def filter_data(components, titles, descriptions,max_length=512):\n",
    "    df[\"combined_texts\"] = [f\"{component} [SEP] {title} [SEP] {description}\" \n",
    "                      for component, title, description in zip(components, titles, descriptions)]\n",
    "    df['token_count'] = df['combined_texts'].apply(lambda x: len(tokenizer.encode(str(x), add_special_tokens=True)))\n",
    "    \n",
    "    # Keep only rows with <= 512 tokens\n",
    "    df_filtered = df[df['token_count'] <= 512].copy()\n",
    "    df_filtered = df_filtered.drop('combined_texts', axis=1)\n",
    "    return df_filtered\n",
    "    \n",
    "    # return inputs\n",
    "train_inputs=filter_data(df[\"Component\"],df[\"Title\"],df[\"Description\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "268c5d6d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:31.695798Z",
     "iopub.status.busy": "2025-04-04T20:18:31.695503Z",
     "iopub.status.idle": "2025-04-04T20:18:32.092732Z",
     "shell.execute_reply": "2025-04-04T20:18:32.092024Z"
    },
    "papermill": {
     "duration": 0.410791,
     "end_time": "2025-04-04T20:18:32.094266",
     "exception": false,
     "start_time": "2025-04-04T20:18:31.683475",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
    "model.to(device)  # Move model to device\n",
    "class_weights_tensor = torch.tensor(class_weights, dtype=torch.float32).to(device)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c8d4942b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.117782Z",
     "iopub.status.busy": "2025-04-04T20:18:32.117474Z",
     "iopub.status.idle": "2025-04-04T20:18:32.121293Z",
     "shell.execute_reply": "2025-04-04T20:18:32.120629Z"
    },
    "papermill": {
     "duration": 0.016953,
     "end_time": "2025-04-04T20:18:32.122665",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.105712",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def tokenize_data(components, titles, descriptions,max_length=512):\n",
    "    combined_texts = [f\"{component} [SEP] {title} [SEP] {description}\" \n",
    "                      for component, title, description in zip(components, titles, descriptions)]\n",
    "    \n",
    "    # Tokenize the combined texts\n",
    "    inputs = tokenizer(combined_texts, padding=\"longest\", truncation=True, return_tensors=\"pt\", max_length=max_length)\n",
    "    \n",
    "    return inputs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "3cd9307b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.146657Z",
     "iopub.status.busy": "2025-04-04T20:18:32.146396Z",
     "iopub.status.idle": "2025-04-04T20:18:32.149762Z",
     "shell.execute_reply": "2025-04-04T20:18:32.149140Z"
    },
    "papermill": {
     "duration": 0.016714,
     "end_time": "2025-04-04T20:18:32.151027",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.134313",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def create_dataset(inputs,labels):\n",
    "    data = Dataset.from_dict({\n",
    "            'input_ids': inputs['input_ids'],\n",
    "            'attention_mask': inputs['attention_mask'],\n",
    "            'labels': labels\n",
    "        })\n",
    "    return data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "034f5dd3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.173769Z",
     "iopub.status.busy": "2025-04-04T20:18:32.173549Z",
     "iopub.status.idle": "2025-04-04T20:18:32.768340Z",
     "shell.execute_reply": "2025-04-04T20:18:32.767338Z"
    },
    "papermill": {
     "duration": 0.607667,
     "end_time": "2025-04-04T20:18:32.769969",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.162302",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_inputs=tokenize_data(train_df[\"Component\"],train_df[\"Title\"],train_df[\"Description\"])\n",
    "val_inputs=tokenize_data(val_df[\"Component\"],val_df[\"Title\"],val_df[\"Description\"])\n",
    "test_inputs=tokenize_data(test_df[\"Component\"],test_df[\"Title\"],test_df[\"Description\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "41b49589",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.793444Z",
     "iopub.status.busy": "2025-04-04T20:18:32.793193Z",
     "iopub.status.idle": "2025-04-04T20:18:32.858954Z",
     "shell.execute_reply": "2025-04-04T20:18:32.858271Z"
    },
    "papermill": {
     "duration": 0.07865,
     "end_time": "2025-04-04T20:18:32.860497",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.781847",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_data=create_dataset(train_inputs,train_df[\"Priority\"])\n",
    "val_data=create_dataset(val_inputs,val_df[\"Priority\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "fdb50b47",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.883961Z",
     "iopub.status.busy": "2025-04-04T20:18:32.883695Z",
     "iopub.status.idle": "2025-04-04T20:18:32.888219Z",
     "shell.execute_reply": "2025-04-04T20:18:32.887500Z"
    },
    "papermill": {
     "duration": 0.017806,
     "end_time": "2025-04-04T20:18:32.889617",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.871811",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class WeightedTrainer(Trainer):\n",
    "    def compute_loss(self, model, inputs, return_outputs=False, num_items_in_batch=None):\n",
    "        # print(inputs)  # Debugging: Check input structure\n",
    "\n",
    "        labels = inputs.pop(\"labels\")  # Extract labels\n",
    "        outputs = model(**inputs)  \n",
    "        logits = outputs.logits  # Extract raw logits (not loss!)\n",
    "\n",
    "        # Compute per-sample loss\n",
    "        loss_fct = torch.nn.CrossEntropyLoss(reduction=\"none\")  # Keep per-sample loss\n",
    "        loss = loss_fct(logits, labels)  # Loss is now a tensor\n",
    "\n",
    "        # Fetch sample weights based on labels\n",
    "        sample_weights = class_weights_tensor[labels]  \n",
    "        # print(\"Sample Weights:\", sample_weights)  # Debugging\n",
    "\n",
    "        # Apply sample weights to per-sample loss\n",
    "        weighted_loss = (loss * sample_weights).mean()  # Scalar loss\n",
    "\n",
    "        return (weighted_loss, outputs) if return_outputs else weighted_loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "66f4a484",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.914239Z",
     "iopub.status.busy": "2025-04-04T20:18:32.914005Z",
     "iopub.status.idle": "2025-04-04T20:18:32.918675Z",
     "shell.execute_reply": "2025-04-04T20:18:32.918056Z"
    },
    "papermill": {
     "duration": 0.017552,
     "end_time": "2025-04-04T20:18:32.919906",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.902354",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def fine_tune_model(train_data,val_data,epochs=3):\n",
    "    from transformers import DataCollatorWithPadding\n",
    "    data_collator = DataCollatorWithPadding(tokenizer=tokenizer)\n",
    "    training_args = TrainingArguments(\n",
    "        output_dir='./results',\n",
    "        overwrite_output_dir=True,\n",
    "        logging_dir='./logs',\n",
    "        logging_strategy=\"steps\",\n",
    "        logging_steps=1500,\n",
    "        warmup_steps=1000,\n",
    "        eval_steps=1500,\n",
    "        save_steps=1500,\n",
    "        num_train_epochs=epochs,\n",
    "        per_device_eval_batch_size=64,\n",
    "        per_device_train_batch_size=16,\n",
    "        # gradient_accumulation_steps=2,  # Gradient accumulation step size\n",
    "        seed=7,\n",
    "        fp16=True,\n",
    "        report_to=[],\n",
    "        optim=\"adafactor\",\n",
    "        weight_decay=0.01,\n",
    "        eval_strategy=\"steps\", \n",
    "        save_strategy=\"steps\",\n",
    "        load_best_model_at_end=True,\n",
    "        save_total_limit=2,\n",
    "        disable_tqdm=True,\n",
    "        # learning_rate=2e-05\n",
    "    )\n",
    "\n",
    "    # Initialize Trainer\n",
    "    trainer = WeightedTrainer(\n",
    "        model=model,\n",
    "        args=training_args,\n",
    "        train_dataset=train_data,\n",
    "        eval_dataset=val_data,\n",
    "        callbacks = [EarlyStoppingCallback(early_stopping_patience=1)],\n",
    "        data_collator=data_collator,\n",
    "    )\n",
    "\n",
    "    # Train the model\n",
    "    trainer.train()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "26efdbbf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:18:32.942826Z",
     "iopub.status.busy": "2025-04-04T20:18:32.942605Z",
     "iopub.status.idle": "2025-04-04T20:19:31.349435Z",
     "shell.execute_reply": "2025-04-04T20:19:31.348499Z"
    },
    "papermill": {
     "duration": 58.430054,
     "end_time": "2025-04-04T20:19:31.360855",
     "exception": false,
     "start_time": "2025-04-04T20:18:32.930801",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'train_runtime': 58.0342, 'train_samples_per_second': 38.77, 'train_steps_per_second': 1.241, 'train_loss': 1.2822845247056749, 'epoch': 3.0}\n"
     ]
    }
   ],
   "source": [
    "fine_tune_model(train_data,val_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "0a61cf5d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:19:31.383636Z",
     "iopub.status.busy": "2025-04-04T20:19:31.383344Z",
     "iopub.status.idle": "2025-04-04T20:19:31.388256Z",
     "shell.execute_reply": "2025-04-04T20:19:31.387673Z"
    },
    "papermill": {
     "duration": 0.017668,
     "end_time": "2025-04-04T20:19:31.389491",
     "exception": false,
     "start_time": "2025-04-04T20:19:31.371823",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def get_embeddings(inputs,batch_size=64):\n",
    "    model.eval()\n",
    "    all_embeddings=[]\n",
    "    input_ids = inputs['input_ids']\n",
    "    attention_mask = inputs['attention_mask']\n",
    "\n",
    "    with torch.no_grad():  # Disable gradient calculation\n",
    "        for i in range(0, len(input_ids), batch_size):\n",
    "            print(f\"Processing batch {i // batch_size + 1}/{(len(input_ids) // batch_size) + 1}\")\n",
    "\n",
    "            # Slice batch inputs\n",
    "            batch_input_ids = input_ids[i:i+batch_size].to(model.device)  # Ensure input is on the correct device\n",
    "            batch_attention_mask = attention_mask[i:i+batch_size].to(model.device)\n",
    "\n",
    "            # Run inference\n",
    "            outputs = model(input_ids=batch_input_ids, attention_mask=batch_attention_mask, output_hidden_states=True)\n",
    "            hidden_states = outputs.hidden_states\n",
    "\n",
    "            # Extract embeddings for CLS token\n",
    "            cls_embeddings = hidden_states[-1][:, 0, :].cpu().numpy()  # Move to CPU and convert to numpy\n",
    "            all_embeddings.extend(cls_embeddings)\n",
    "\n",
    "    # Convert list of embeddings to DataFrame\n",
    "    embeddings_df = pd.DataFrame(all_embeddings)\n",
    "    return embeddings_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "b6ad49cd",
   "metadata": {
    "_kg_hide-output": true,
    "execution": {
     "iopub.execute_input": "2025-04-04T20:19:31.411945Z",
     "iopub.status.busy": "2025-04-04T20:19:31.411703Z",
     "iopub.status.idle": "2025-04-04T20:19:48.245003Z",
     "shell.execute_reply": "2025-04-04T20:19:48.244290Z"
    },
    "papermill": {
     "duration": 16.845979,
     "end_time": "2025-04-04T20:19:48.246429",
     "exception": false,
     "start_time": "2025-04-04T20:19:31.400450",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Processing batch 1/12\n",
      "Processing batch 2/12\n",
      "Processing batch 3/12\n",
      "Processing batch 4/12\n",
      "Processing batch 5/12\n",
      "Processing batch 6/12\n",
      "Processing batch 7/12\n",
      "Processing batch 8/12\n",
      "Processing batch 9/12\n",
      "Processing batch 10/12\n",
      "Processing batch 11/12\n",
      "Processing batch 12/12\n",
      "Processing batch 1/4\n",
      "Processing batch 2/4\n",
      "Processing batch 3/4\n",
      "Processing batch 4/4\n",
      "Processing batch 1/2\n",
      "Processing batch 2/2\n"
     ]
    }
   ],
   "source": [
    "train_embedded=get_embeddings(train_inputs)\n",
    "val_embedded=get_embeddings(val_inputs)\n",
    "test_embedded=get_embeddings(test_inputs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "8580e92b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:19:48.271335Z",
     "iopub.status.busy": "2025-04-04T20:19:48.271085Z",
     "iopub.status.idle": "2025-04-04T20:19:48.274822Z",
     "shell.execute_reply": "2025-04-04T20:19:48.274015Z"
    },
    "papermill": {
     "duration": 0.017329,
     "end_time": "2025-04-04T20:19:48.276128",
     "exception": false,
     "start_time": "2025-04-04T20:19:48.258799",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_df.reset_index(drop=True, inplace=True)\n",
    "val_df.reset_index(drop=True, inplace=True)\n",
    "test_df.reset_index(drop=True, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "5bbe65c4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:19:48.300154Z",
     "iopub.status.busy": "2025-04-04T20:19:48.299934Z",
     "iopub.status.idle": "2025-04-04T20:19:48.306105Z",
     "shell.execute_reply": "2025-04-04T20:19:48.305526Z"
    },
    "papermill": {
     "duration": 0.019367,
     "end_time": "2025-04-04T20:19:48.307219",
     "exception": false,
     "start_time": "2025-04-04T20:19:48.287852",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_embedded_df=pd.concat([train_df,train_embedded],axis=1)\n",
    "val_embedded_df=pd.concat([val_df,val_embedded],axis=1)\n",
    "test_embedded_df=pd.concat([test_df,test_embedded],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "a6fa8e77",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:19:48.331367Z",
     "iopub.status.busy": "2025-04-04T20:19:48.331139Z",
     "iopub.status.idle": "2025-04-04T20:19:49.104628Z",
     "shell.execute_reply": "2025-04-04T20:19:49.103899Z"
    },
    "papermill": {
     "duration": 0.787228,
     "end_time": "2025-04-04T20:19:49.106105",
     "exception": false,
     "start_time": "2025-04-04T20:19:48.318877",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_embedded_df.to_csv(\"/kaggle/working/train_embedded_df.csv\",index=False)\n",
    "val_embedded_df.to_csv(\"/kaggle/working/val_embedded_df.csv\",index=False)\n",
    "test_embedded_df.to_csv(\"/kaggle/working/test_embedded_df.csv\",index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "a875ee71",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-04-04T20:19:49.130633Z",
     "iopub.status.busy": "2025-04-04T20:19:49.130353Z",
     "iopub.status.idle": "2025-04-04T20:19:49.728967Z",
     "shell.execute_reply": "2025-04-04T20:19:49.728136Z"
    },
    "papermill": {
     "duration": 0.612135,
     "end_time": "2025-04-04T20:19:49.730429",
     "exception": false,
     "start_time": "2025-04-04T20:19:49.118294",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "('./saved_model/tokenizer_config.json',\n",
       " './saved_model/special_tokens_map.json',\n",
       " './saved_model/vocab.txt',\n",
       " './saved_model/added_tokens.json',\n",
       " './saved_model/tokenizer.json')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "save_directory = \"./saved_model\"\n",
    "\n",
    "# Save model and tokenizer\n",
    "model.save_pretrained(save_directory)\n",
    "tokenizer.save_pretrained(save_directory)"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "databundleVersionId": 9687564,
     "sourceId": 85506,
     "sourceType": "competition"
    },
    {
     "sourceId": 231386022,
     "sourceType": "kernelVersion"
    }
   ],
   "dockerImageVersionId": 30919,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 118.978709,
   "end_time": "2025-04-04T20:19:52.789505",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-04-04T20:17:53.810796",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "0108e2c36f954ef3b84c5bfb46dd4849": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "014893a1caca4268870a20f990a5a9dd": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "0be1da1a9ebd425895b0542355acad2e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "0e81439803954c1cb2a8c97264131d36": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "0f032f9810454fcc951409c3ef5e7008": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_430bf83c9ef245d59b6b8a0534a7e434",
        "IPY_MODEL_b07a707a0b8042ac85e95aa3d1399a5f",
        "IPY_MODEL_4ee3df4683e24b06b6539812fa08643a"
       ],
       "layout": "IPY_MODEL_34d702718dad4ce0986a5fc20f2b4438",
       "tabbable": null,
       "tooltip": null
      }
     },
     "1410c139673f4dc0a8b29f1d2b0fbe30": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_b62d362d9457417c8e215de2043e6aec",
       "max": 435797.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_1faa63fd24e5405d9dd39c03d534bd2d",
       "tabbable": null,
       "tooltip": null,
       "value": 435797.0
      }
     },
     "1faa63fd24e5405d9dd39c03d534bd2d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "232e94dbc6d24fe38dc4c107baf6d581": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "295f3f44c0fc4026a3f3b7ab57c211c9": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_373ff5b3fb37498fbac6c47d4cd32979",
       "placeholder": "​",
       "style": "IPY_MODEL_b4f4b5a3abf94b13972b837147df6b57",
       "tabbable": null,
       "tooltip": null,
       "value": "config.json: 100%"
      }
     },
     "2e6116f4a91d4751acc2ca011b77c9cc": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "314e7d99e6c1431ca4c0f45282d7b98a": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "33f64756a2824030836f15858246157d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "34d702718dad4ce0986a5fc20f2b4438": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "373ff5b3fb37498fbac6c47d4cd32979": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "430bf83c9ef245d59b6b8a0534a7e434": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_e176633b6244446bad822789aa5d96ae",
       "placeholder": "​",
       "style": "IPY_MODEL_232e94dbc6d24fe38dc4c107baf6d581",
       "tabbable": null,
       "tooltip": null,
       "value": "vocab.txt: 100%"
      }
     },
     "49bf7b3d2d96479988d54496e8b9d9b9": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "4ee3df4683e24b06b6539812fa08643a": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_fb9d3438ac194118850a36115cd6e9db",
       "placeholder": "​",
       "style": "IPY_MODEL_9fdd2540e6c64cc1b6fec5446ca1ea7f",
       "tabbable": null,
       "tooltip": null,
       "value": " 213k/213k [00:00&lt;00:00, 6.38MB/s]"
      }
     },
     "4ef195657afe4fc6ab5cf70cfaadb240": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "52abff24caee491e8a90f549f1d45b9c": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "5d86889c4e99499ea4b21fc33f66004d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "5e85d19f006d4b8ea28f7a915cabd9e6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_ef8218ad50c846bdb038ee111f4c1797",
       "placeholder": "​",
       "style": "IPY_MODEL_49bf7b3d2d96479988d54496e8b9d9b9",
       "tabbable": null,
       "tooltip": null,
       "value": " 263M/263M [00:01&lt;00:00, 257MB/s]"
      }
     },
     "5f2d42dc4d3b4507b67d5b33175a94e4": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_c878b681f7634d8f879c604d1274e1b8",
       "placeholder": "​",
       "style": "IPY_MODEL_af758b958cdf401aaf85b99e47d99ce6",
       "tabbable": null,
       "tooltip": null,
       "value": "model.safetensors: 100%"
      }
     },
     "5ffa7ecb50dc4b5a865f4774a66a41c3": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "6baba4eda2a148b0819009e12c43defe": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "73360bad083a49faadedc431f8247cac": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "87cfd4595f334d4692ee72098511cd90": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "8b4e39d342d64a368cbdafe042243f0f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "8ff891d45c804d7a82318610b47be420": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "945cdb65930540fbb590858f36cb211a": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_0e81439803954c1cb2a8c97264131d36",
       "max": 465.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_0be1da1a9ebd425895b0542355acad2e",
       "tabbable": null,
       "tooltip": null,
       "value": 465.0
      }
     },
     "98ca1a3838174d3bad0e612bcf19ab7b": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_8ff891d45c804d7a82318610b47be420",
       "placeholder": "​",
       "style": "IPY_MODEL_d1e1d068e355495e8cc6b3f94dcbc5b2",
       "tabbable": null,
       "tooltip": null,
       "value": "tokenizer.json: 100%"
      }
     },
     "9abfbd9100ca47778c62762b6db93b19": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_295f3f44c0fc4026a3f3b7ab57c211c9",
        "IPY_MODEL_945cdb65930540fbb590858f36cb211a",
        "IPY_MODEL_cd7f0378e8c542439f77ae9c05552216"
       ],
       "layout": "IPY_MODEL_bee9a382d0b545d29c35c2f7ed49e80c",
       "tabbable": null,
       "tooltip": null
      }
     },
     "9ddcaa427a6242318d4c035caf78b7db": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_73360bad083a49faadedc431f8247cac",
       "max": 49.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_33f64756a2824030836f15858246157d",
       "tabbable": null,
       "tooltip": null,
       "value": 49.0
      }
     },
     "9fdd2540e6c64cc1b6fec5446ca1ea7f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "a6e6a1b615514be689dc61e5bd26a00e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_87cfd4595f334d4692ee72098511cd90",
       "placeholder": "​",
       "style": "IPY_MODEL_f9c66cce83f043e7bc7eedc1792185ce",
       "tabbable": null,
       "tooltip": null,
       "value": " 436k/436k [00:00&lt;00:00, 27.7MB/s]"
      }
     },
     "ac2d3e9868ca460db4583f223ff1225c": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "af758b958cdf401aaf85b99e47d99ce6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "b07a707a0b8042ac85e95aa3d1399a5f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_014893a1caca4268870a20f990a5a9dd",
       "max": 213450.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_ac2d3e9868ca460db4583f223ff1225c",
       "tabbable": null,
       "tooltip": null,
       "value": 213450.0
      }
     },
     "b360e2ea6a4843f0a4b45cc2e999ef3c": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_5f2d42dc4d3b4507b67d5b33175a94e4",
        "IPY_MODEL_b8466a62b2054dc09ff43e5f29aff2b4",
        "IPY_MODEL_5e85d19f006d4b8ea28f7a915cabd9e6"
       ],
       "layout": "IPY_MODEL_b8140b8feefa48288e1700e040673298",
       "tabbable": null,
       "tooltip": null
      }
     },
     "b4f4b5a3abf94b13972b837147df6b57": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "b62d362d9457417c8e215de2043e6aec": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "b8140b8feefa48288e1700e040673298": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "b8466a62b2054dc09ff43e5f29aff2b4": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_6baba4eda2a148b0819009e12c43defe",
       "max": 263260784.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_5d86889c4e99499ea4b21fc33f66004d",
       "tabbable": null,
       "tooltip": null,
       "value": 263260784.0
      }
     },
     "ba2be813b40847c69a4c83c3c8b34072": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_bfefdf42c4024abc8b43be8d5cf4dc54",
        "IPY_MODEL_9ddcaa427a6242318d4c035caf78b7db",
        "IPY_MODEL_e16b87e58c374c71b3b8b3fb2e4f4803"
       ],
       "layout": "IPY_MODEL_52abff24caee491e8a90f549f1d45b9c",
       "tabbable": null,
       "tooltip": null
      }
     },
     "bee9a382d0b545d29c35c2f7ed49e80c": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "bfefdf42c4024abc8b43be8d5cf4dc54": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_2e6116f4a91d4751acc2ca011b77c9cc",
       "placeholder": "​",
       "style": "IPY_MODEL_5ffa7ecb50dc4b5a865f4774a66a41c3",
       "tabbable": null,
       "tooltip": null,
       "value": "tokenizer_config.json: 100%"
      }
     },
     "c878b681f7634d8f879c604d1274e1b8": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "cd7f0378e8c542439f77ae9c05552216": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_4ef195657afe4fc6ab5cf70cfaadb240",
       "placeholder": "​",
       "style": "IPY_MODEL_0108e2c36f954ef3b84c5bfb46dd4849",
       "tabbable": null,
       "tooltip": null,
       "value": " 465/465 [00:00&lt;00:00, 49.0kB/s]"
      }
     },
     "d1e1d068e355495e8cc6b3f94dcbc5b2": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "e16b87e58c374c71b3b8b3fb2e4f4803": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_314e7d99e6c1431ca4c0f45282d7b98a",
       "placeholder": "​",
       "style": "IPY_MODEL_8b4e39d342d64a368cbdafe042243f0f",
       "tabbable": null,
       "tooltip": null,
       "value": " 49.0/49.0 [00:00&lt;00:00, 4.31kB/s]"
      }
     },
     "e176633b6244446bad822789aa5d96ae": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "e8df476ae22b4eddb1a11edff665b5cb": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "ef8218ad50c846bdb038ee111f4c1797": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "f7cde791ecf147629067f1f4d4d763dd": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_98ca1a3838174d3bad0e612bcf19ab7b",
        "IPY_MODEL_1410c139673f4dc0a8b29f1d2b0fbe30",
        "IPY_MODEL_a6e6a1b615514be689dc61e5bd26a00e"
       ],
       "layout": "IPY_MODEL_e8df476ae22b4eddb1a11edff665b5cb",
       "tabbable": null,
       "tooltip": null
      }
     },
     "f9c66cce83f043e7bc7eedc1792185ce": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "fb9d3438ac194118850a36115cd6e9db": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
